<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % DISTRO_SPECIFICS SYSTEM "distro-specifics.ent">
<!ENTITY DISTRO_MAINMENU '<guimenu>the main menu on the panel (the menu with the "f" icon)</guimenu>'>
<!ENTITY % SYSTEM_CONFIG_NFS_DISTRO_SPECIFICS SYSTEM "system-config-nfs-distro-specifics.ent">
<!ENTITY SYSTEM_CONFIG_NFS_TOOL "NFS Server Configuration Tool">
<!ENTITY SYSTEM_CONFIG_NFS_INVOCATION '
    <indexterm significance="normal">
        <primary><command>system-config-nfs</command>
        </primary>
        <see>&SYSTEM_CONFIG_NFS_TOOL;</see>
    </indexterm>

    <para>
        You must be running the <application>X</application> Window System and have root privileges to use the &SYSTEM_CONFIG_NFS_TOOL;. To start the application on the desktop, go to <menuchoice>&DISTRO_MAINMENU;<guisubmenu>System</guisubmenu><guisubmenu>Administration</guisubmenu><guisubmenu>Server Settings</guisubmenu><guimenuitem>NFS</guimenuitem></menuchoice>.
    </para>
'>
<!ENTITY SYSTEM_CONFIG_NFS_ABSTRACT SYSTEM "system-config-nfs-abstract.xml">
<!ENTITY SYSTEM_CONFIG_NFS_CONTENT SYSTEM "system-config-nfs-content.xml">
<!ENTITY SYSTEM_CONFIG_NFS_HOSTNAME_FORMATS SYSTEM "system-config-nfs-hostname-formats.xml">
]>
<article lang="zh_CN"><title>NFS服务器配置</title><articleinfo><revhistory><revision><revnumber>1.0</revnumber><date>2008-01-17</date></revision><revision><revnumber>1.0.1</revnumber><date>2008-03-12</date></revision></revhistory><abstract role="description"><para>网络文件系统(NFS)可以帮助用户像在自己计算机上一样在网络间共享文件。您的计算机可以是NFS服务器，也可以是NFS客户端。这就是说可以将文件系统共享给其它计算机，也可以挂载其它计算机共享的文件系统。</para><para>NFS通过共享目录来共享顶层目录下的文件，共享目录这个又叫做“导出”目录。 <application>NFS 服务配置（NFS·Server·Configuration Tool）</application>可以用来为一个系统配置NFS服务.</para>
</abstract><authorgroup><corpauthor role="maintainer"><trademark class="registered">Red Hat</trademark>, Inc.</corpauthor></authorgroup></articleinfo>    <para>网络文件系统(NFS)可以帮助用户像在自己计算机上一样在网络间共享文件。您的计算机可以是NFS服务器，也可以是NFS客户端。这就是说可以将文件系统共享给其它计算机，也可以挂载其它计算机共享的文件系统。</para><para>NFS通过共享目录来共享顶层目录下的文件，共享目录这个又叫做“导出”目录。 <application>NFS 服务配置（NFS·Server·Configuration Tool）</application>可以用来为一个系统配置NFS服务.</para>


    <indexterm significance="normal"><primary><command>system-config-nfs</command>
        </primary><see>NFS服务器配置工具</see></indexterm><para>您必须使用<application>X</application>桌面系统并且有root权限才可以使用NFS服务器配置工具。要启动该程序，请到<menuchoice><guimenu>面板主菜单(带有'f'图标的)下的</guimenu><guisubmenu>System</guisubmenu><guisubmenu>Administration</guisubmenu><guisubmenu>Server Settings</guisubmenu><guimenuitem>NFS</guimenuitem></menuchoice>。</para>

	
	<figure float="0" id="fig-system-config-nfs"><title><application>NFS服务器配置工具</application></title><mediaobject><imageobject><imagedata fileref="images/system-config-nfs.png" format="PNG"/></imageobject><textobject><para>NFS配置工具</para></textobject></mediaobject></figure>

	<para>按照某些防火墙设置，您可能需要为NFS守护进程指定一个端口。NFS服务器设置允许您为每个进程指定端口，而不是由端口映射的随机端口。您可通过点击<guibutton>Server Settings</guibutton>按钮来进行NFS服务器设置。下图是一个NFS服务器配置窗口。</para>
	<figure float="0" id="fig-nfs-server-settings"><title><application>NFS服务器设置</application></title><mediaobject><imageobject><imagedata fileref="images/system-config-nfs-server-settings.png" format="PNG"/></imageobject><textobject><para>NFS服务器设置</para></textobject></mediaobject></figure>
	<section id="s2-nfs-export"><title>输出或共享NFS文件系统</title><indexterm significance="normal"><primary>NFS</primary><secondary>输出</secondary></indexterm><indexterm significance="normal"><primary>输出NFS文件系统</primary></indexterm><indexterm significance="normal"><primary>文件系统</primary><secondary>NFS</secondary><see>NFS</see></indexterm><indexterm significance="normal"><primary><application>NFS服务器配置工具</application></primary></indexterm><para>从NFS服务器共享文件称为 "exporting" 目录下的文件。<application>NFS服务器配置工具</application>用来将系统配置为NFS服务器。</para><para>点<guibutton>Add</guibutton>按钮来添加NFS共享。<xref linkend="fig-add-share"/>中显示的对话框将出现。</para><para><guilabel>Basic</guilabel>选项需要如下信息：</para><itemizedlist><listitem><para><guilabel>Directory</guilabel>—指定要共享的目录，例如<filename>/tmp</filename>。</para></listitem><listitem><para><guilabel>Host(s)</guilabel> — 指定要共享的主机。参考<xref linkend="s2-nfs-hostname-formats"/>以了解关于格式上的解释。</para></listitem><listitem><para><guilabel>Basic permissions</guilabel> —指定目录是否具有只读或读/写权限。</para></listitem></itemizedlist><figure float="0" id="fig-add-share"><title>添加共享</title><mediaobject><imageobject><imagedata fileref="images/system-config-nfs-add-basic.png" format="PNG"/></imageobject><textobject><para>添加NFS共享</para></textobject></mediaobject></figure><para><guilabel>General Options</guilabel>选项允许设置如下内容：</para><figure float="0" id="fig-nfs-general-options"><title>NFS通用选项</title><mediaobject><imageobject><imagedata fileref="images/system-config-nfs-add-general-options.png" format="PNG"/></imageobject><textobject><para>通用选项</para></textobject></mediaobject></figure><itemizedlist><listitem><para><guilabel>允许来自1024及以上端口的连接</guilabel> — 低于1024端口的服务需要以root启动。选择此选项以允许root之外的用户启动NFS服务。此选项对应于<command>insecure</command>。</para></listitem><listitem><para><guilabel>允许不安全文件锁定</guilabel> —无需锁定请求。此选项对应于<command>insecure_locks</command>。</para></listitem><listitem><para><guilabel>Disable subtree checking</guilabel>—如果输出的只是文件系统的子目录，而非整个文件系统，服务器将检查请求的文件是否位于子目录中。这叫做<firstterm>subtree checking</firstterm>。选择此选项来禁用子目录检查。如果输出的是整个文件系统，选择禁用可增加传输速率。此选项对应于 <command>no_subtree_check</command>。</para></listitem><listitem><para><guilabel>Sync write operations on request</guilabel> — 此选项默认开启，在请求所作的更改未写入磁盘前不允许服务器回复请求。该选项对应于<command>sync</command>。如果未启用此选项，则使用 <command>async</command>。</para><itemizedlist><listitem><para><guilabel>Force sync of write operations immediately</guilabel> — 不延迟磁盘写入。此选项对应于<command>no_wdelay</command>。</para></listitem></itemizedlist></listitem><listitem><para><guilabel>Hide filesystems beneath</guilabel>用来开启或关闭<command>nohide</command>选项。<command>nohide</command>选项关闭后，会显示嵌套的目录。这样客户端就可以从文件系统的父目录浏览而不需注意任何更改。</para></listitem><listitem><para><guilabel>Export only if mounted</guilabel>用来设置<command>mountpoint</command>选项，以允许仅当目录被挂载后才可输出。</para></listitem><listitem><para><guilabel>Optional Mount Point</guilabel>指定路径到额外的挂载点。点击<guibutton>Browse</guibutton>来选择合适的挂载点或者输入输入路径。</para></listitem><listitem><para><guilabel>Set explicit Filesystem ID:</guilabel>用来设置<command>fsid=X</command>选项。这主要用在簇设置中。在所有簇中使用统一的文件系统ID以避免产生旧的NFS文件句柄。</para></listitem></itemizedlist><figure float="0" id="fig-nfs-user-access"><title>NFS用户访问</title><mediaobject><imageobject><imagedata fileref="images/system-config-nfs-add-user-access.png" format="PNG"/></imageobject><textobject><para>用户访问</para></textobject></mediaobject></figure><para><guilabel>User Access</guilabel>选项可配置以下内容：</para><itemizedlist><listitem><para><guilabel>Treat remote root user as local root</guilabel> — 默认情况下，root用户的用户和组ID均为0。Root squashing将ID为0的用户和组映射给匿名的用户和组，这样客户端的root就不会拥有NFS服务器的root权限。若选择此选项，root不会映射到匿名，这使得客户端的root用户拥有输出目录的权限。启用此选项会极大地降低系统的安全性。若不是非常需要，则不要启用它。该选项对应于<command>no_root_squash</command>。</para></listitem><listitem><para><guilabel>Treat all client users as anonymous users</guilabel> — 若选择该选项，所有用户ID和组ID都将被映射为匿名用户。此选项对应于<command>all_squash</command></para><itemizedlist><listitem><para><guilabel>Specify local user ID for anonymous users</guilabel> — 如果选择<guilabel>Treat all client users as anonymous users</guilabel>，此选项可让您为匿名用户指定一个用户ID。此选项对应于<command>anonuid</command>。</para></listitem><listitem><para><guilabel>Specify local group ID for anonymous users</guilabel> — 如果选择<guilabel>Treat all client users as anonymous users</guilabel>，此选项可让您为匿名用户指定一个组ID。此选项对应于<command>anongid</command>。</para></listitem></itemizedlist></listitem></itemizedlist><para>要编辑已有NFS共享，请从列表中选择，然后点<guibutton>Properties</guibutton>按钮。要删除已有NFS共享，请在列表中选择，然后点<guibutton>Delete</guibutton>按钮。</para><indexterm significance="normal"><primary><filename>/etc/exports</filename></primary></indexterm><indexterm significance="normal"><primary><filename>输出</filename></primary></indexterm><para>点击<guibutton>OK</guibutton>以从列表中添加，编辑或删除NFS共享之后，变更立即生效 — 服务器守护进程重启，另存旧配置文件为<filename>/etc/exports.bak</filename>。新的配置写入<filename>/etc/exports</filename>。</para><para><application>NFS服务器配置工具</application>直接读写配置文件<filename>/etc/exports</filename>。因此使用配置工具后也可以手动修改配置文件，手动修改配置文件后仍可以使用用该配置工具 (提供的文件经过了语法修正)。</para></section>
<appendix><title>附录</title><section id="s2-nfs-hostname-formats"><title>主机名格式</title><indexterm significance="normal"><primary>NFS</primary><secondary>主机名格式</secondary></indexterm><para>主机可以是一下的格式：</para><itemizedlist><listitem><para>单机 — 完全合格的域名 (可被服务器解析)，主机名(可被服务器解析)或IP地址。</para></listitem><listitem><para>由通配符指定一系列计算机 — 使用 * 或 ? 指定符合的字符串。通配符不能用于IP地址，但是当DNS反向查询失败时偶尔也会见效。在完全合格的域名中指定通配符时，点 (.) 不算做通配符。例如，<computeroutput>*.example.com</computeroutput>包括 one.example.com但不包括 one.two.example.com。</para></listitem><listitem><para>IP地址 —格式为<replaceable>a.b.c.d/z</replaceable>，<replaceable>a.b.c.d</replaceable>为网络地址，<replaceable>z</replaceable>为子网掩码的位数(例如，192.168.0.0/24)。另外可用的格式为<replaceable>a.b.c.d/netmask</replaceable>，其中<replaceable>a.b.c.d</replaceable>为网络地址， <replaceable>netmask</replaceable>为子网掩码(例如，192.168.100.8/255.255.255.0)。</para></listitem><listitem><para>网络组 — 格式为<replaceable>@group-name</replaceable>，其中<replaceable>group-name</replaceable>是NIS网络组名。</para></listitem></itemizedlist></section>
</appendix></article>
