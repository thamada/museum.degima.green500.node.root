<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % DISTRO_SPECIFICS SYSTEM "distro-specifics.ent">
<!ENTITY DISTRO_MAINMENU '<guimenu>the main menu on the panel (the menu with the "f" icon)</guimenu>'>
<!ENTITY % SYSTEM_CONFIG_NFS_DISTRO_SPECIFICS SYSTEM "system-config-nfs-distro-specifics.ent">
<!ENTITY SYSTEM_CONFIG_NFS_TOOL "NFS Server Configuration Tool">
<!ENTITY SYSTEM_CONFIG_NFS_INVOCATION '
    <indexterm significance="normal">
        <primary><command>system-config-nfs</command>
        </primary>
        <see>&SYSTEM_CONFIG_NFS_TOOL;</see>
    </indexterm>

    <para>
        You must be running the <application>X</application> Window System and have root privileges to use the &SYSTEM_CONFIG_NFS_TOOL;. To start the application on the desktop, go to <menuchoice>&DISTRO_MAINMENU;<guisubmenu>System</guisubmenu><guisubmenu>Administration</guisubmenu><guisubmenu>Server Settings</guisubmenu><guimenuitem>NFS</guimenuitem></menuchoice>.
    </para>
'>
<!ENTITY SYSTEM_CONFIG_NFS_ABSTRACT SYSTEM "system-config-nfs-abstract.xml">
<!ENTITY SYSTEM_CONFIG_NFS_CONTENT SYSTEM "system-config-nfs-content.xml">
<!ENTITY SYSTEM_CONFIG_NFS_HOSTNAME_FORMATS SYSTEM "system-config-nfs-hostname-formats.xml">
]>
<article lang="ru"><title>Настройка сервера NFS</title><articleinfo><revhistory><revision><revnumber>1.0</revnumber><date>2008-01-17</date></revision><revision><revnumber>1.0.1</revnumber><date>2008-03-12</date></revision></revhistory><abstract role="description"><para>Network File System (NFS, сетевая файловая система) обеспечивает использование файлов по сети, как если бы они находились на локальном жёстком диске. Ваша машина может быть как клиентом, так и сервером NFS, это означает что вы можете экспортировать данные и монтировать файловые системы других компьютеров.</para><para>Доступ к файлам для NFS сервера осуществляется на уровне так называемых «экспортируемых» каталогов, которые содержат эти файлы. Для конфигурации сервера NFS можно использовать графическую утилиту настройки.</para>
</abstract><authorgroup><corpauthor role="maintainer"><trademark class="registered">Red Hat</trademark>, Inc.</corpauthor></authorgroup><copyright><year>2009.</year><holder>Sergey Nikolaevich Raspopov (qwerty3456@mail.ru)</holder></copyright></articleinfo>    <para>Network File System (NFS, сетевая файловая система) обеспечивает использование файлов по сети, как если бы они находились на локальном жёстком диске. Ваша машина может быть как клиентом, так и сервером NFS, это означает что вы можете экспортировать данные и монтировать файловые системы других компьютеров.</para><para>Доступ к файлам для NFS сервера осуществляется на уровне так называемых «экспортируемых» каталогов, которые содержат эти файлы. Для конфигурации сервера NFS можно использовать графическую утилиту настройки.</para>


    <indexterm significance="normal"><primary><command>system-config-nfs</command>
        </primary><see>Инструмент для настройки сервера NFS</see></indexterm><para>Вы должны запустить <application>X</application> Window System и иметь привилегии root, чтобы настраивать сервер NFS с помощью данной утилиты. Чтобы запустить приложение с рабочего стола, в <menuchoice><guimenu>главном меню на панели задач (с изображением значка "f")</guimenu> выберите <guisubmenu>Система</guisubmenu><guisubmenu>Администрирование</guisubmenu><guisubmenu>Настройка сервера</guisubmenu><guimenuitem>NFS</guimenuitem></menuchoice>.</para>

	
	<figure float="0" id="fig-system-config-nfs"><title><application>Инструмент для настройки сервера NFS</application></title><mediaobject><imageobject><imagedata fileref="images/system-config-nfs.png" format="PNG"/></imageobject><textobject><para>Менеджер настройки NFS</para></textobject></mediaobject></figure>

	<para>В зависимости от настроек вашего брандмауэра, возможно, вам понадобится настроить процесс NFS для использования конкретных портов. Вы можете установить нужные настройки сервера NFS, нажав кнопку <guibutton>Параметры сервера</guibutton>. На рисунке ниже показано окно параметров сервера NFS.</para>
	<figure float="0" id="fig-nfs-server-settings"><title><application>Параметры сервера NFS</application></title><mediaobject><imageobject><imagedata fileref="images/system-config-nfs-server-settings.png" format="PNG"/></imageobject><textobject><para>Параметры сервера NFS</para></textobject></mediaobject></figure>
	<section id="s2-nfs-export"><title>Экспортирование и совместное пользование файловой системы NFS </title><indexterm significance="normal"><primary>NFS</primary><secondary>Экспортирование</secondary></indexterm><indexterm significance="normal"><primary>Экспортирование файловой системы NFS</primary></indexterm><indexterm significance="normal"><primary>файловая система</primary><secondary>NFS</secondary><see>NFS</see></indexterm><indexterm significance="normal"><primary><application>Инструмент для настройки сервера NFS</application></primary></indexterm><para>Совместный доступ или передача файлов с помощью сервера NFS называется «экспортирование» директорий вместе с содержащимися файлами. <application>Утилита настройки сервера NFS</application> используется для настройки системы как NFS сервера.</para><para>Чтобы добавить ресурс NFS, щёлкните на кнопке <guibutton>Добавить</guibutton>. Появится окно <xref linkend="fig-add-share"/>.</para><para>Закладка <guilabel>Основные</guilabel> имеет следующие элементы:</para><itemizedlist><listitem><para><guilabel>Каталог</guilabel> — Укажите путь к каталогу, который следует открыть для общего доступа, например <filename>/tmp</filename>.</para></listitem><listitem><para><guilabel>Узлы</guilabel> — Укажите узлы, которые будут иметь доступ к директории. <xref linkend="s2-nfs-hostname-formats"/> содержит дополнительную информацию.</para></listitem><listitem><para><guilabel>Основные права доступа</guilabel> — Укажите права на чтение или чтение и изменение содержимого для каталога.</para></listitem></itemizedlist><figure float="0" id="fig-add-share"><title>Добавить ресурс</title><mediaobject><imageobject><imagedata fileref="images/system-config-nfs-add-basic.png" format="PNG"/></imageobject><textobject><para>Добавить NFS ресурс</para></textobject></mediaobject></figure><para>Закладка <guilabel>Основные параметры</guilabel> содержит следующие опции:</para><figure float="0" id="fig-nfs-general-options"><title>Основные параметры NFS</title><mediaobject><imageobject><imagedata fileref="images/system-config-nfs-add-general-options.png" format="PNG"/></imageobject><textobject><para>Основные параметры</para></textobject></mediaobject></figure><itemizedlist><listitem><para><guilabel>Разрешить соединения с портов 1024 и выше</guilabel> — Службы запущенные на портах меньше 1024 должны быть запущены с правами root. Выберите эту опцию, чтобы разрешить работу службы NFS для непривилегированных пользователей. Эта опция соответствует директиве <command>insecure</command>.</para></listitem><listitem><para><guilabel>Разрешить небезопасную блокировку файлов</guilabel> — Не требовать запроса на блокировку. Эта опция соответствует директиве <command>insecure_locks</command>.</para></listitem><listitem><para><guilabel>Запретить проверку подкаталогов</guilabel> — Если экспортируется подкаталог в файловой системе, а не вся файловая система, сервер проверяет, чтобы запрашиваемый файл находился в поддиректории экспортируемой директории. Эта проверка называется <firstterm>проверка поддиректорий</firstterm>. Выберите эту опцию чтобы отключить проверку поддиректорий. Это может привести к увеличению скорости передачи данных. Опция соответствует директиве <command>no_subtree_check</command>.</para></listitem><listitem><para><guilabel>Синхронизировать операции записи по запросу</guilabel> — Включённая по умолчанию, эта опция не позволяет серверу отвечать на запрос прежде чем изменения будут записаны на жёсткий диск. Эта опция соответствует директиве <command>sync</command>. Если опция не выбрана, то используется опция <command>async</command>.</para><itemizedlist><listitem><para><guilabel>Принудительно синхронизировать операции записи немедленно</guilabel> — Опция не позволяет задержки записи на жёсткий диск. Соответствует директиве <command>no_wdelay</command>.</para></listitem></itemizedlist></listitem><listitem><para><guilabel>Скрыть файловые системы ниже</guilabel> включает или отключает директиву <command>nohide</command>. Если <command>nohide</command> отключена, вложенные каталоги показываются. Клиенты могут перемещаться по файловой системе не замечая каких-либо изменений.</para></listitem><listitem><para><guilabel>Экспортировать, если смонтировано</guilabel> — Опция позволяет экспортировать директорию, если она была смонтирована.</para></listitem><listitem><para><guilabel>Дополнительные точки монтирования</guilabel> — Путь к дополнительной точке монтирования. Щелкните на кнопке <guibutton>Обзор</guibutton>, чтобы указать точку монтирования, или наберите путь вручную.</para></listitem><listitem><para><guilabel>Явно задать идентификатор файловой системы:</guilabel> устанавливает директиву <command>fsid=X</command>. В основном используется в кластерных системах. Используется постоянный идентификатор файловой системы в кластерах, имеющих большое количество NFS указателей.</para></listitem></itemizedlist><figure float="0" id="fig-nfs-user-access"><title>Пользовательский доступ NFS</title><mediaobject><imageobject><imagedata fileref="images/system-config-nfs-add-user-access.png" format="PNG"/></imageobject><textobject><para>Пользовательский доступ</para></textobject></mediaobject></figure><para>Закладка <guilabel>Доступ пользователей</guilabel> содержит следующие опции для настройки:</para><itemizedlist><listitem><para><guilabel>Рассматривать удалённого пользователя root как локального пользователя root</guilabel> — по умолчанию, ID пользователя и группы root - 0.  ID root изменятся с ID пользователя 0, и ID группы 0 на ID анонимного пользователя, чтобы при подключении пользователь root клиента не имел прав root на NFS сервере. Если опция установлена, root не будет заменён на анонимного пользователя, и клиент будет использовать привилегии root к экспортируемой системе. Выбрав эту опцию, можно серьёзно нарушить безопасность системы. Не используйте эту директиву, если вы не уверены в последствиях. Опция соответствует директиве  <command>no_root_squash</command>.</para></listitem><listitem><para><guilabel>Рассматривать всех пользователей клиентов как анонимных пользователей </guilabel> — Если эта опция выбрана, все ID пользователей и групп клиента обрабатываться как анонимные. Эта опция соответствует директиве <command>all_squash</command>.</para><itemizedlist><listitem><para><guilabel>Укажите ID локального пользователя для анонимных пользователей:</guilabel> — если опция <guilabel>Рассматривать всех пользователей клиентов как анонимных пользователей </guilabel> выбрана, то здесь можно указать ID анонимного пользователя в локальной системе. Эта опция соответствует директиве <command>anonuid</command>.</para></listitem><listitem><para><guilabel>Укажите ID локальной группы для анонимных пользователей:</guilabel> — если опция <guilabel>Рассматривать всех пользователей клиентов как анонимных пользователей </guilabel> выбрана, то здесь можно указать ID группы анонимного пользователя в локальной системе. Эта опция соответствует директиве <command>anonugid</command>.</para></listitem></itemizedlist></listitem></itemizedlist><para>Чтобы редактировать существующий ресурс, выберите его из списка и щёлкните на кнопке <guibutton>Свойства</guibutton>. Чтобы удалить существующий ресурс, выберите его в списке и нажмите кнопку <guibutton>Удалить</guibutton>.</para><indexterm significance="normal"><primary><filename>/etc/exports</filename></primary></indexterm><indexterm significance="normal"><primary><filename>Экспорт</filename></primary></indexterm><para>После щелчка по кнопке <guibutton>OK</guibutton> при добавлении, редактировании или удалении NFS ресурса из списка, изменения будут применены — служба будет перезапущена и старая конфигурация будет сохранена как <filename>/etc/exports.bak</filename>. Новая конфигурация будет записана как <filename>/etc/exports</filename>.</para><para><application>Утилита настройки сервера NFS</application> читает и пишет напрямую в конфигурационный файл <filename>/etc/exports</filename>. Поэтому файл может быть изменён вручную после редактирования утилитой, или изменение с помощью утилиты после редактирования вручную (конечно, если файл будет иметь правильный синтаксис).</para></section>
<appendix><title>Дополнение</title><section id="s2-nfs-hostname-formats"><title>Формат имён узлов</title><indexterm significance="normal"><primary>NFS</primary><secondary>формат имен узлов</secondary></indexterm><para>Узлы могут быть следующих форматов:</para><itemizedlist><listitem><para>Единичная машина — Полная доменная запись (которую сможет разрешить сервер), имя узла (которое сможет разрешить сервер) или IP адрес.</para></listitem><listitem><para>Группа машин с определённой маской имени — используйте символы * или ? чтобы создать маску. Маска не может быть использована с IP адресом; сервер может принять его за имя узла и завершить работу, если не сможет разрешить имя узла. Если указанная маска полностью подходит для имени домена, точка(.) не входит в маску. Например <computeroutput>*.example.com</computeroutput> включает one.example.com, но не подходит для one.two.example.com.</para></listitem><listitem><para>IP сеть — Используйте <replaceable>a.b.c.d/z</replaceable>, где <replaceable>a.b.c.d</replaceable> это сеть и <replaceable>z</replaceable> это число бит в маске (например 192.168.0.0/24). Другой подходящий формат это <replaceable>a.b.c.d/netmask</replaceable>, где <replaceable>a.b.c.d</replaceable> это сеть, а <replaceable>netmask</replaceable> это маска сети (например 192.168.100.8/255.255.255.0).</para></listitem><listitem><para>Сетевая группа — в формате <replaceable>@group-name</replaceable>, где <replaceable>group-name</replaceable> это NIS имя группы сети.</para></listitem></itemizedlist></section>
</appendix></article>
