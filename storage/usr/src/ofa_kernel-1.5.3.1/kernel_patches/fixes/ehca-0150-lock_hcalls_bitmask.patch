Fix reading capability bit from device capabilities.

Signed-off-by: Alexander Schmidt <alexs@linux.vnet.ibm.com>
---

 drivers/infiniband/hw/ehca/ehca_main.c |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

Index: ofa_kernel-1.5.2/drivers/infiniband/hw/ehca/ehca_main.c
===================================================================
--- ofa_kernel-1.5.2.orig/drivers/infiniband/hw/ehca/ehca_main.c	2010-06-11 04:03:56.000000000 -0400
+++ ofa_kernel-1.5.2/drivers/infiniband/hw/ehca/ehca_main.c	2010-06-11 04:47:47.000000000 -0400
@@ -359,7 +359,8 @@
 	 * a firmware property, so it's valid across all adapters
 	 */
 	if (ehca_lock_hcalls == -1)
-		ehca_lock_hcalls = !(shca->hca_cap & HCA_CAP_H_ALLOC_RES_SYNC);
+		ehca_lock_hcalls = !EHCA_BMASK_GET(HCA_CAP_H_ALLOC_RES_SYNC,
+					shca->hca_cap);
 
 	/* translate supported MR page sizes; always support 4K */
 	shca->hca_cap_mr_pgsize = EHCA_PAGESIZE;
